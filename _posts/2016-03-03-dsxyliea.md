---
layout: post
category : Programming
tags : [dyslexia, typoglycemia, Javascript]
title: Dsxyliea
---


A friend who has dyslexia described to me how she experiences reading. She *can* read, but it takes a lot of concentration, and the letters seems to "jump around".

I remembered reading about [typoglycemia](https://en.wikipedia.org/wiki/Typoglycemia). Wouldn't it be possible to do it interactively on a website with Javascript? Sure it would.

Feel like making a bookmarklet of this or something? [Fork it](https://github.com/geon/geon.github.com/blob/master/_posts/2016-03-03-dsxyliea.md) on github.

> Whoosh! The cold wind roared through the trees and between buildings. Winter was on its way. Amaya was warm in her house, thinking about an article she’d read at school. The article had been aboutkids who helped out theircommunities, and she thought it would be really cool to help her own town, Harvard.

> The only problem was that she wasn’t sure how to help. What did her town need that a kid could do? In the article, the kids had grown food for people who needed food, but it was winter. She couldn’t start a garden. Amaya was still deep in thought when her mom said it was time to go grocery shopping.

> As they drove along the road, Amaya saw a family walking on the sidewalk, wearing only light jackets. How cold they must be, Amaya thought. That gave her an idea! She could help her town, she could collect winter coats, hats, and gloves for people in Harvard who needed them.

> She shared her idea with her mom, who thought it was a great idea. But how would they spread the word so that they could get a lot of winter clothing? Amaya decided to talk to her teacher, because then she could share her idea with her classmates at least.

> Mrs. Monroe was very supportive when Amaya talked about her idea. She even said she could help Amaya talk to the principal about it, so they could get the whole school involved! They decided to call the project “Hats in Harvard,” and they wrote up a letter explaining the idea to the families. Mrs. Monroe said they could even have the third graders take a field trip to parks around Harvard where families in need gathered to drop off the coats, hats, and gloves. Amaya was excited, and really hoped the principal, Mrs. Brown, would let the school participate!

> Amaya and Mrs. Monroe met with the principal one day during lunch time. Mrs. Brown was thrilled with the idea, and said she would make sure copies of the letter went home with all the students! They collected the winter clothing for a few weeks, then were able to take their field trip to two parks in the area to leave the clothes where families who needed them could get them.

> Three days after their field trip, Amaya and her mom were once again driving together. She saw the same family walking together that had given her the idea for Hats in Harvard. This time, though, the family looked nice and warm in some new coats, hats, and gloves. Amaya felt a warm glow in her heart, and was very glad she could help her community.

*Source: [Wikipedia](http://en.wikipedia.org/wiki/Dyslexia)*




<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script type="text/javascript">

"use strict";

$(function(){

	var getTextNodesIn = function(el) {
	    return $(el).find(":not(iframe,script)").addBack().contents().filter(function() {
	        return this.nodeType == 3;
	    });
	};

	// var textNodes = getTextNodesIn($("p, h1, h2, h3"));
	var textNodes = getTextNodesIn($("*"));



	function isLetter(char) {
		return /^[\d]$/.test(char);
	}


	var wordsInTextNodes = [];
	for (var i = 0; i < textNodes.length; i++) {
		var node = textNodes[i];

		var words = []

		var re = /\w+/g;
		var match;
		while ((match = re.exec(node.nodeValue)) != null) {

			var word = match[0];
			var position = match.index;

			words.push({
				length: word.length,
				position: position
			});
		}

		wordsInTextNodes[i] = words;
	};


	function messUpWords () {

		for (var i = 0; i < textNodes.length; i++) {

			var node = textNodes[i];

			for (var j = 0; j < wordsInTextNodes[i].length; j++) {

				// Only change a tenth of the words each round.
				if (Math.random() > 1/10) {

					continue;
				}

				var wordMeta = wordsInTextNodes[i][j];

				var word = node.nodeValue.slice(wordMeta.position, wordMeta.position + wordMeta.length);
				var before = node.nodeValue.slice(0, wordMeta.position);
				var after  = node.nodeValue.slice(wordMeta.position + wordMeta.length);

				node.nodeValue = before + messUpWord(word) + after;
			};
		};
	}

	function messUpWord (word) {

		if (word.length < 3) {

			return word;
		}

		return word[0] + messUpMessyPart(word.slice(1, -1)) + word[word.length - 1];
	}

	function messUpMessyPart (messyPart) {

		if (messyPart.length < 2) {

			return messyPart;
		}

		var a, b;
		while (!(a < b)) {

			a = getRandomInt(0, messyPart.length - 1);
			b = getRandomInt(0, messyPart.length - 1);
		}

		return messyPart.slice(0, a) + messyPart[b] + messyPart.slice(a+1, b) + messyPart[a] + messyPart.slice(b+1);
	}

	// From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random
	function getRandomInt(min, max) {
		
		return Math.floor(Math.random() * (max - min + 1) + min);
	}


	setInterval(messUpWords, 50);
});


</script>
